
<style type="text/css">
    table.dataintable {
        margin-top: 15px;
        border-collapse: collapse;
        border: 1px solid #aaa;
        width: 100%;
    }

        table.dataintable th {
            font-size: 15px;
            vertical-align: baseline;
            padding: 5px 15px 5px 6px;
            background-color: #3F3F3F;
            border: 1px solid #3F3F3F;
            text-align: center;
            color: #fff;
        }

        table.dataintable td {
            text-align: center;
            font-size: 15px;
            vertical-align: text-top;
            padding: 6px 15px 6px 6px;
            border: 1px solid #aaa;
        }

        table.dataintable tr:nth-child(odd) {
            background-color: #F5F5F5;
        }

        table.dataintable tr:nth-child(even) {
            background-color: #fff;
        }



    #aa {
        font: small-caps 13px/2em bold "幼圆", sans-serif;
        line-height: 1.8em;
        text-indent: 2em;
        color: #0f3ba3;
    }
</style>

<script>
    // 打开一个 web socket
    $(function () {
        document.getElementById('Serve_id').style.background = '#48484A';
        document.getElementById('Serve_id').style.borderButton = '1px solid ';
        document.getElementById('Serve_id').style.padding = '7px 12px 17px 12px ';
        $("#deviceID").val(getCookie("deviceID"));
    });
    var ws;
    function ToggleConnectionClicked() {
        try {
            ws = new WebSocket("ws://210.45.254.83:9999/");//连接服务器
            ws.onopen = function () { alert("已经与服务器建立了连接\r\n当前连接状态：" + this.readyState); };
            ws.onmessage = function (event) { alert("接收到服务器发送的数据：\r\n" + event.data); };
            ws.onclose = function (event) { alert("已经与服务器断开连接\r\n当前连接状态：" + this.readyState); };
            ws.onerror = function (event) { alert("WebSocket异常！"); };
        } catch (ex) {
            alert(ex.message);
        }
    };

    function SendData() {
        var deviceID = $("#deviceID").val();
        $.ajax({
            url: '/ConnectServer/VerifyDevice', //后台处理程序
            type: 'post',         //数据发送方式
            dataType: 'text',     //接受数据格式
            data: { deviceID: deviceID },        //要传递的数据
            success: function (result) {
                if (result == "Success") {
                    try {
                        ws.send(deviceID);
                    } catch (ex) {
                        alert(ex.message);
                    }
                }
                else {
                    alert("此设备未连接！");
                }
            }
        });

    };

    function seestate() {
        alert(ws.readyState);
    }
</script>

<div class="easyui-layout" style="width: 100%; height: 100%; border: 1px solid #484A56" data-options="fit:true">
    <!--左边布局-->
    <div region="west" style="width:200px; padding:2px;" title="服务" split="true">
        <div id="aa" class="easyui-accordion" style="width:auto;height:auto">
            <div title="远程通信" iconCls="icon-ok" style="overflow:auto;padding:10px" selected="true">
                <a href="/ConnectServer/connServer" style="line-height: 150%; font-size: 14px; font-family: YouYuan; text-decoration: none">远程通信</a> <br>
            </div>
            <div title="设备管理" iconCls="icon-ok" style="padding:10px" >
                <a href="/ConnectServer/deviceManage" style="line-height: 150%; font-size: 14px; font-family: YouYuan; text-decoration: none">设备管理</a> <br>
            </div>
            <div title="用户管理" iconCls="icon-ok" style="padding:10px">
                <a href="/ConnectServer/UserManage" style="line-height: 150%; font-size: 14px; font-family: YouYuan; text-decoration: none">用户管理</a> <br>
            </div>
        </div>
    </div>
    <!--中间布局-->
    <div region="center" style="width: 100%; float: left; background: #333743;">
        <div id="tt" class="easyui-tabs" style="width:700px;height:250px" fit="true">
            <div title="远程通信" style="padding:10px" data-options="closable:false">
                <div id="xz">
                    <div id="patternxz" style="color: #15181d; font-weight: 900; font-size: 25px;text-align:center;letter-spacing:5px; ">
                        远程通信界面
                    </div>
                    <p></p>
                    <p style="position:absolute; left:410px;top:78px;font-weight: 900;font-size: 14px; font-family: YouYuan; ">设备ID:</p><input type="text" title="设备ID" id="deviceID" style="position:absolute; left:470px;top:90px" /><br /><br />
                    <br /><br />
                    <button type="button" onclick="ToggleConnectionClicked();" style="width:100px;height:40px; position:absolute; left:480px; ">连接服务器</button><br /><br />

                    <br /><br />
                    <button type="button" onclick="SendData();" style="width:100px;height:40px; position:absolute; left:480px; ">发送</button><br /><br />

                    <br /><br />
                    <button type="button" onclick="seestate();" style="width:100px;height:40px; position:absolute; left:480px; ">查看连接状态</button><br /><br />

                </div>
            </div>
        </div>
    </div>
</div>



